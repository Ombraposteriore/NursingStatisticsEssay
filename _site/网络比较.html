<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>网络比较</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./有调节的网络.html" rel="next">
<link href="./横断面网络.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./横断面网络.html">网络分析实战</a></li><li class="breadcrumb-item"><a href="./网络比较.html">网络比较</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
        <div class="sidebar-tools-collapse">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-collapse-item" href="https://github.com/hulitongjisuibi/hulitongjisuibi.github.io">
            Source Code
            </a>
          </li>
      </ul>
    </div>
</div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">关于本书</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./基础知识.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">基础知识</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">网络分析实战</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./横断面网络.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">横断面网络</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./网络比较.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">网络比较</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./有调节的网络.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">有调节的网络</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./交叉滞后网络.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">交叉滞后网络</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./时间网络分析.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">时间网络分析</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#导入工具包" id="toc-导入工具包" class="nav-link active" data-scroll-target="#导入工具包">1 导入工具包</a></li>
  <li><a href="#整理数据" id="toc-整理数据" class="nav-link" data-scroll-target="#整理数据">2 整理数据</a></li>
  <li><a href="#建模并计算可预测性" id="toc-建模并计算可预测性" class="nav-link" data-scroll-target="#建模并计算可预测性">3 建模并计算可预测性</a></li>
  <li><a href="#网络比较" id="toc-网络比较" class="nav-link" data-scroll-target="#网络比较">4 网络比较</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">网络比较</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>这节内容不多，介绍并演示如何采用R软件进行不同网络的比较，主要内容请见右上角的目录。</p>
<p>为避免出现版本兼容性问题，大家可以先看看我使用的编程环境（见文末）。</p>
<section id="导入工具包" class="level3">
<h3 class="anchored" data-anchor-id="导入工具包">1 导入工具包</h3>
<p>分别需要以下R包，没有安装的请先安装，安装方法见上一节。</p>
</section>
<section id="整理数据" class="level3">
<h3 class="anchored" data-anchor-id="整理数据">2 整理数据</h3>
<p>这里使用的是bfi人格问卷数据，这份数据是R语言内置的公开数据集。具体细节请使用?psych::bfi查询。</p>
<p>网络分析比较吃硬件资源，所以这次我们仅选取少量数据进行分析：500x15，即500人，15个条目。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>md <span class="ot">=</span> bfi[<span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>] </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(md)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   500 obs. of  15 variables:
 $ A1: int  2 2 5 4 2 6 2 4 4 2 ...
 $ A2: int  4 4 4 4 3 6 5 3 3 5 ...
 $ A3: int  3 5 5 6 3 5 5 1 6 6 ...
 $ A4: int  4 2 4 5 4 6 3 5 3 6 ...
 $ A5: int  4 5 4 5 5 5 5 1 3 5 ...
 $ C1: int  2 5 4 4 4 6 5 3 6 6 ...
 $ C2: int  3 4 5 4 4 6 4 2 6 5 ...
 $ C3: int  3 4 4 3 5 6 4 4 3 6 ...
 $ C4: int  4 3 2 5 3 1 2 2 4 2 ...
 $ C5: int  4 4 5 5 2 3 3 4 5 1 ...
 $ E1: int  3 1 2 5 2 2 4 3 5 2 ...
 $ E2: int  3 1 4 3 2 1 3 6 3 2 ...
 $ E3: int  3 6 4 4 5 6 4 4 NA 4 ...
 $ E4: int  4 4 4 4 4 5 5 2 4 5 ...
 $ E5: int  4 3 5 4 5 6 5 1 3 5 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(md)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      A1 A2 A3 A4 A5 C1 C2 C3 C4 C5 E1 E2 E3 E4 E5
61617  2  4  3  4  4  2  3  3  4  4  3  3  3  4  4
61618  2  4  5  2  5  5  4  4  3  4  1  1  6  4  3
61620  5  4  5  4  4  4  5  4  2  5  2  4  4  4  5
61621  4  4  6  5  5  4  4  3  5  5  5  3  4  4  4
61622  2  3  3  4  5  4  4  5  3  2  2  2  5  4  5
61623  6  6  5  6  5  6  6  6  1  3  2  1  6  5  6</code></pre>
</div>
</div>
<p>由于横断面网络分析不能有缺失值，所以剔除有缺失值的行。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>md<span class="ot">=</span><span class="fu">na.omit</span>(md) </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(md)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   468 obs. of  15 variables:
 $ A1: int  2 2 5 4 2 6 2 4 2 4 ...
 $ A2: int  4 4 4 4 3 6 5 3 5 4 ...
 $ A3: int  3 5 5 6 3 5 5 1 6 5 ...
 $ A4: int  4 2 4 5 4 6 3 5 6 6 ...
 $ A5: int  4 5 4 5 5 5 5 1 5 5 ...
 $ C1: int  2 5 4 4 4 6 5 3 6 4 ...
 $ C2: int  3 4 5 4 4 6 4 2 5 3 ...
 $ C3: int  3 4 4 3 5 6 4 4 6 5 ...
 $ C4: int  4 3 2 5 3 1 2 2 2 3 ...
 $ C5: int  4 4 5 5 2 3 3 4 1 2 ...
 $ E1: int  3 1 2 5 2 2 4 3 2 1 ...
 $ E2: int  3 1 4 3 2 1 3 6 2 3 ...
 $ E3: int  3 6 4 4 5 6 4 4 4 2 ...
 $ E4: int  4 4 4 4 4 5 5 2 5 5 ...
 $ E5: int  4 3 5 4 5 6 5 1 5 4 ...
 - attr(*, "na.action")= 'omit' Named int [1:32] 9 63 66 72 90 107 112 130 133 168 ...
  ..- attr(*, "names")= chr [1:32] "61630" "61754" "61759" "61772" ...</code></pre>
</div>
</div>
<p>为这份选用的内置数据集添加一个分组变量sex（模拟）：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#设置随机数种子</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#模拟抽样</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>md<span class="sc">$</span>sex <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">size =</span> <span class="dv">468</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>根据sex对数据进行分组：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>male_data<span class="ot">=</span> <span class="fu">as.matrix</span>(md <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="dv">1</span>))[,<span class="sc">-</span><span class="dv">16</span>]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>female_data<span class="ot">=</span> <span class="fu">as.matrix</span>(md <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sex<span class="sc">==</span> <span class="dv">2</span>))[,<span class="sc">-</span><span class="dv">16</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="建模并计算可预测性" class="level3">
<h3 class="anchored" data-anchor-id="建模并计算可预测性">3 建模并计算可预测性</h3>
<section id="男性网络" class="level4">
<h4 class="anchored" data-anchor-id="男性网络">3.1 “男性”网络</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>male_pre_mod <span class="ot">=</span> <span class="fu">mgm</span>(<span class="at">data =</span> male_data,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">type =</span> <span class="fu">rep</span>(<span class="st">'g'</span>,<span class="dv">15</span>),</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">level =</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">15</span>),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">lambdaSel =</span> <span class="st">"CV"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">ruleReg =</span> <span class="st">"AND"</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>              <span class="co"># pbar = TRUE, </span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">overparameterize =</span> <span class="cn">FALSE</span>, </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">signInfo =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |-----                                                                 |   7%
  |                                                                            
  |---------                                                             |  13%
  |                                                                            
  |--------------                                                        |  20%
  |                                                                            
  |-------------------                                                   |  27%
  |                                                                            
  |-----------------------                                               |  33%
  |                                                                            
  |----------------------------                                          |  40%
  |                                                                            
  |---------------------------------                                     |  47%
  |                                                                            
  |-------------------------------------                                 |  53%
  |                                                                            
  |------------------------------------------                            |  60%
  |                                                                            
  |-----------------------------------------------                       |  67%
  |                                                                            
  |---------------------------------------------------                   |  73%
  |                                                                            
  |--------------------------------------------------------              |  80%
  |                                                                            
  |-------------------------------------------------------------         |  87%
  |                                                                            
  |-----------------------------------------------------------------     |  93%
  |                                                                            
  |----------------------------------------------------------------------| 100%</code></pre>
</div>
</div>
<p>计算可预测性值：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>male_pred_mgm <span class="ot">=</span> <span class="fu">predict</span>(<span class="at">object =</span> male_pre_mod , </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> male_data,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">errorCon =</span> <span class="fu">c</span>(<span class="st">"R2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>排序看看效果：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>male_pred_mgm<span class="sc">$</span>errors <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(R2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Variable    R2
1        A5 0.479
2        A3 0.449
3        A2 0.412
4        E2 0.406
5        C2 0.385
6        E4 0.382
7        E5 0.360
8        C4 0.355
9        E1 0.329
10       E3 0.316
11       C5 0.290
12       A4 0.266
13       C3 0.252
14       C1 0.237
15       A1 0.221</code></pre>
</div>
</div>
<p>接下来，用bootnet包绘制带有可预测性值的网络图，先估计网络：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>Network_male <span class="ot">=</span> <span class="fu">estimateNetwork</span>(male_data, <span class="at">default =</span> <span class="st">"EBICglasso"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Estimating Network. Using package::function:
  - qgraph::EBICglasso for EBIC model selection
    - using glasso::glasso</code></pre>
</div>
</div>
<p>再绘图，把male_pred_mgm$errors塞进去：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Network_male,<span class="at">layout =</span> <span class="st">"spring"</span>,</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">pie=</span>male_pred_mgm<span class="sc">$</span>errors[,<span class="dv">2</span>]</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="网络比较_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="女性网络" class="level4">
<h4 class="anchored" data-anchor-id="女性网络">3.2 “女性”网络</h4>
<p>同样的做法：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算女性网络</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>female_pre_mod <span class="ot">=</span> <span class="fu">mgm</span>(<span class="at">data =</span> female_data,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">type =</span> <span class="fu">rep</span>(<span class="st">'g'</span>,<span class="dv">15</span>),</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">level =</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">15</span>),</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">lambdaSel =</span> <span class="st">"CV"</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ruleReg =</span> <span class="st">"AND"</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># pbar = TRUE, </span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">overparameterize =</span> <span class="cn">FALSE</span>, </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">signInfo =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |-----                                                                 |   7%
  |                                                                            
  |---------                                                             |  13%
  |                                                                            
  |--------------                                                        |  20%
  |                                                                            
  |-------------------                                                   |  27%
  |                                                                            
  |-----------------------                                               |  33%
  |                                                                            
  |----------------------------                                          |  40%
  |                                                                            
  |---------------------------------                                     |  47%
  |                                                                            
  |-------------------------------------                                 |  53%
  |                                                                            
  |------------------------------------------                            |  60%
  |                                                                            
  |-----------------------------------------------                       |  67%
  |                                                                            
  |---------------------------------------------------                   |  73%
  |                                                                            
  |--------------------------------------------------------              |  80%
  |                                                                            
  |-------------------------------------------------------------         |  87%
  |                                                                            
  |-----------------------------------------------------------------     |  93%
  |                                                                            
  |----------------------------------------------------------------------| 100%</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>female_pred_mgm <span class="ot">=</span> <span class="fu">predict</span>(<span class="at">object =</span> female_pre_mod , </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> female_data,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">errorCon =</span> <span class="fu">c</span>(<span class="st">"R2"</span>))</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>female_pred_mgm<span class="sc">$</span>errors <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(R2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Variable    R2
1        E2 0.488
2        A5 0.460
3        E4 0.442
4        A2 0.416
5        E1 0.393
6        E5 0.372
7        C4 0.365
8        C2 0.361
9        A3 0.340
10       C3 0.311
11       C5 0.308
12       E3 0.291
13       C1 0.272
14       A1 0.197
15       A4 0.197</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 可视化（带有可预测值的网络图）</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootnet)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>Network_female <span class="ot">=</span> <span class="fu">estimateNetwork</span>(female_data, <span class="at">default =</span> <span class="st">"EBICglasso"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Estimating Network. Using package::function:
  - qgraph::EBICglasso for EBIC model selection
    - using glasso::glasso</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Network_female,<span class="at">layout =</span> <span class="st">"spring"</span>,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">pie=</span>female_pred_mgm<span class="sc">$</span>errors[,<span class="dv">2</span>]</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="网络比较_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="网络比较" class="level3">
<h3 class="anchored" data-anchor-id="网络比较">4 网络比较</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>nct_res<span class="ot">=</span><span class="fu">NCT</span>(Network_male, </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>              Network_female, </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">gamma=</span><span class="fl">0.5</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">it =</span> <span class="dv">100</span>, </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">test.edges=</span>T,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">test.centrality =</span>T,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">centrality =</span> <span class="fu">c</span>(<span class="st">"strength"</span>,<span class="st">"expectedInfluence"</span>),</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">p.adjust.methods =</span> <span class="st">'BH'</span> <span class="co">#Bonferroni-Holm校正</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>              ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Note: Input is a bootnetResult object, argument 'gamma' is ignored.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Note: estimateNetwork object used - estimation method has possibly not been validated.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=                                                                     |   1%
  |                                                                            
  |=                                                                     |   2%
  |                                                                            
  |==                                                                    |   3%
  |                                                                            
  |===                                                                   |   4%
  |                                                                            
  |====                                                                  |   5%
  |                                                                            
  |====                                                                  |   6%
  |                                                                            
  |=====                                                                 |   7%
  |                                                                            
  |======                                                                |   8%
  |                                                                            
  |======                                                                |   9%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |========                                                              |  11%
  |                                                                            
  |========                                                              |  12%
  |                                                                            
  |=========                                                             |  13%
  |                                                                            
  |==========                                                            |  14%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |=============                                                         |  18%
  |                                                                            
  |=============                                                         |  19%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |===============                                                       |  21%
  |                                                                            
  |===============                                                       |  22%
  |                                                                            
  |================                                                      |  23%
  |                                                                            
  |=================                                                     |  24%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |==================                                                    |  26%
  |                                                                            
  |===================                                                   |  27%
  |                                                                            
  |====================                                                  |  28%
  |                                                                            
  |====================                                                  |  29%
  |                                                                            
  |=====================                                                 |  30%
  |                                                                            
  |======================                                                |  31%
  |                                                                            
  |======================                                                |  32%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |========================                                              |  34%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |=============================                                         |  41%</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in EBICglassoCore(S = S, n = n, gamma = gamma, penalize.diagonal =
penalize.diagonal, : A dense regularized network was selected (lambda &lt; 0.1 *
lambda.max). Recent work indicates a possible drop in specificity. Interpret
the presence of the smallest edges with care. Setting threshold = TRUE will
enforce higher specificity, at the cost of sensitivity.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
  |                                                                            
  |=============================                                         |  42%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |=================================                                     |  47%
  |                                                                            
  |==================================                                    |  48%
  |                                                                            
  |==================================                                    |  49%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |====================================                                  |  51%
  |                                                                            
  |====================================                                  |  52%
  |                                                                            
  |=====================================                                 |  53%
  |                                                                            
  |======================================                                |  54%
  |                                                                            
  |======================================                                |  55%
  |                                                                            
  |=======================================                               |  56%
  |                                                                            
  |========================================                              |  57%
  |                                                                            
  |=========================================                             |  58%
  |                                                                            
  |=========================================                             |  59%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |===========================================                           |  61%
  |                                                                            
  |===========================================                           |  62%
  |                                                                            
  |============================================                          |  63%
  |                                                                            
  |=============================================                         |  64%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |==============================================                        |  66%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |================================================                      |  68%
  |                                                                            
  |================================================                      |  69%
  |                                                                            
  |=================================================                     |  70%
  |                                                                            
  |==================================================                    |  71%
  |                                                                            
  |==================================================                    |  72%
  |                                                                            
  |===================================================                   |  73%
  |                                                                            
  |====================================================                  |  74%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |=====================================================                 |  76%
  |                                                                            
  |======================================================                |  77%
  |                                                                            
  |=======================================================               |  78%
  |                                                                            
  |=======================================================               |  79%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |=========================================================             |  82%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |===========================================================           |  84%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |============================================================          |  86%
  |                                                                            
  |=============================================================         |  87%
  |                                                                            
  |==============================================================        |  88%
  |                                                                            
  |==============================================================        |  89%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |================================================================      |  91%
  |                                                                            
  |================================================================      |  92%
  |                                                                            
  |=================================================================     |  93%
  |                                                                            
  |==================================================================    |  94%
  |                                                                            
  |==================================================================    |  95%
  |                                                                            
  |===================================================================   |  96%
  |                                                                            
  |====================================================================  |  97%
  |                                                                            
  |===================================================================== |  98%
  |                                                                            
  |===================================================================== |  99%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>注意：为节省时间，本例调小了 iteration，实际研究可以设为1000次，</p>
</blockquote>
<p>查看比较结果：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(nct_res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> INDEPENDENT GROUPS GAUSSIAN NETWORK COMPARISON TEST 

 P-VALUE CORRECTION: BH 

 NETWORK INVARIANCE TEST 
 Test statistic M: 0.1676208 
 p-value 0.7425743 

 GLOBAL STRENGTH INVARIANCE TEST 
 Global strength per group:  5.562555 5.089144 
 Test statistic S:  0.4734111 
 p-value 0.5742574

 EDGE INVARIANCE TEST 
    Var1 Var2  p-value Test statistic E
16    A1   A2 1.000000       0.10615517
31    A1   A3 1.000000       0.01237609
32    A2   A3 1.000000       0.01127489
46    A1   A4 1.000000       0.00000000
47    A2   A4 1.000000       0.08596382
48    A3   A4 0.984888       0.11086448
61    A1   A5 1.000000       0.00000000
62    A2   A5 1.000000       0.00499569
63    A3   A5 0.984888       0.11312876
64    A4   A5 1.000000       0.06577270
76    A1   C1 1.000000       0.00000000
77    A2   C1 1.000000       0.01488558
78    A3   C1 1.000000       0.01412830
79    A4   C1 1.000000       0.00000000
80    A5   C1 1.000000       0.00000000
91    A1   C2 1.000000       0.00000000
92    A2   C2 1.000000       0.00000000
93    A3   C2 1.000000       0.00000000
94    A4   C2 1.000000       0.04108561
95    A5   C2 1.000000       0.00000000
96    C1   C2 1.000000       0.07496657
106   A1   C3 1.000000       0.00000000
107   A2   C3 1.000000       0.02744867
108   A3   C3 0.984888       0.08828290
109   A4   C3 0.984888       0.02020913
110   A5   C3 1.000000       0.00000000
111   C1   C3 1.000000       0.05339232
112   C2   C3 1.000000       0.02400531
121   A1   C4 0.984888       0.10427325
122   A2   C4 0.984888       0.00835040
123   A3   C4 1.000000       0.00000000
124   A4   C4 1.000000       0.00000000
125   A5   C4 1.000000       0.00000000
126   C1   C4 1.000000       0.04099892
127   C2   C4 1.000000       0.04963448
128   C3   C4 1.000000       0.07389777
136   A1   C5 0.984888       0.02146873
137   A2   C5 1.000000       0.00000000
138   A3   C5 1.000000       0.00146984
139   A4   C5 0.984888       0.09117639
140   A5   C5 1.000000       0.00627621
141   C1   C5 1.000000       0.01867252
142   C2   C5 1.000000       0.00074883
143   C3   C5 1.000000       0.07700686
144   C4   C5 1.000000       0.10472963
151   A1   E1 1.000000       0.00000000
152   A2   E1 1.000000       0.02608205
153   A3   E1 1.000000       0.00000000
154   A4   E1 1.000000       0.00000000
155   A5   E1 0.984888       0.09226009
156   C1   E1 0.984888       0.01426443
157   C2   E1 1.000000       0.00000000
158   C3   E1 1.000000       0.00000000
159   C4   E1 0.984888       0.05423056
160   C5   E1 1.000000       0.00000000
166   A1   E2 1.000000       0.00000000
167   A2   E2 1.000000       0.00000000
168   A3   E2 0.984888       0.05956537
169   A4   E2 1.000000       0.01340442
170   A5   E2 1.000000       0.06475690
171   C1   E2 1.000000       0.02032345
172   C2   E2 1.000000       0.00000000
173   C3   E2 1.000000       0.00000000
174   C4   E2 0.984888       0.01661791
175   C5   E2 1.000000       0.02469459
176   E1   E2 0.984888       0.16762076
181   A1   E3 1.000000       0.00000000
182   A2   E3 1.000000       0.10080111
183   A3   E3 1.000000       0.05829463
184   A4   E3 1.000000       0.00343567
185   A5   E3 0.984888       0.10894307
186   C1   E3 1.000000       0.00000000
187   C2   E3 1.000000       0.00000000
188   C3   E3 1.000000       0.00000000
189   C4   E3 1.000000       0.00000000
190   C5   E3 1.000000       0.00000000
191   E1   E3 1.000000       0.03019699
192   E2   E3 1.000000       0.12410464
196   A1   E4 1.000000       0.00000000
197   A2   E4 1.000000       0.01339703
198   A3   E4 0.984888       0.09636629
199   A4   E4 1.000000       0.02392767
200   A5   E4 0.984888       0.11141297
201   C1   E4 1.000000       0.06128627
202   C2   E4 1.000000       0.00000000
203   C3   E4 1.000000       0.00000000
204   C4   E4 1.000000       0.00000000
205   C5   E4 0.984888       0.01782709
206   E1   E4 1.000000       0.08184600
207   E2   E4 1.000000       0.10924500
208   E3   E4 1.000000       0.06110927
211   A1   E5 1.000000       0.02892689
212   A2   E5 0.984888       0.07951405
213   A3   E5 1.000000       0.00000000
214   A4   E5 1.000000       0.02207959
215   A5   E5 1.000000       0.05169003
216   C1   E5 1.000000       0.05735957
217   C2   E5 1.000000       0.04823892
218   C3   E5 1.000000       0.06983841
219   C4   E5 1.000000       0.01234043
220   C5   E5 1.000000       0.02373487
221   E1   E5 1.000000       0.00436893
222   E2   E5 1.000000       0.09707638
223   E3   E5 1.000000       0.04389252
224   E4   E5 1.000000       0.00461165


 CENTRALITY INVARIANCE TEST 
 Nodes tested: A1 A2 A3 A4 A5 C1 C2 C3 C4 C5 E1 E2 E3 E4 E5 
 Centralities tested: strength expectedInfluence
 Test statistics C: 
       strength expectedInfluence
A1  0.036137609       0.273200114
A2  0.072080703       0.215526141
A3  0.225294525       0.127976286
A4  0.217718255       0.008556629
A5  0.062591855      -0.238889701
C1 -0.080319204      -0.055796218
C2  0.142201888       0.041435265
C3 -0.029364145      -0.331173409
C4  0.113917146      -0.256526846
C5  0.092794640      -0.209927273
E1 -0.001361695      -0.442340943
E2  0.069795182      -0.388883349
E3  0.108517464      -0.200085787
E4 -0.075592078       0.014860103
E5 -0.007589970      -0.282631195

 p-values: 
    strength expectedInfluence
A1 0.9900990         0.6930693
A2 0.9900990         0.8415842
A3 0.8415842         0.9900990
A4 0.8415842         0.9900990
A5 0.9900990         0.8415842
C1 0.9900990         0.9900990
C2 0.9900990         0.9900990
C3 0.9900990         0.8415842
C4 0.9900990         0.8415842
C5 0.9900990         0.8415842
E1 0.9900990         0.6930693
E2 0.9900990         0.6930693
E3 0.9900990         0.8415842
E4 0.9900990         0.9900990
E5 0.9900990         0.8415842</code></pre>
</div>
</div>
<p>NETWORK INVARIANCE TEST是网络不变性检验，GLOBAL STRENGTH INVARIANCE TEST是全局强度不变性检验，EDGE INVARIANCE TEST是边缘不变性检验，CENTRALITY INVARIANCE TEST是中心性不变性检验。</p>
<p><strong>运行环境：</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.3.2 (2023-10-31 ucrt)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19045)

Matrix products: default


locale:
[1] LC_COLLATE=Chinese (Simplified)_China.utf8 
[2] LC_CTYPE=Chinese (Simplified)_China.utf8   
[3] LC_MONETARY=Chinese (Simplified)_China.utf8
[4] LC_NUMERIC=C                               
[5] LC_TIME=Chinese (Simplified)_China.utf8    

time zone: Asia/Shanghai
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] psych_2.3.9                 dplyr_1.1.4                
[3] mgm_1.2-14                  NetworkComparisonTest_2.2.2
[5] bootnet_1.6                 ggplot2_3.5.0              

loaded via a namespace (and not attached):
  [1] mnormt_2.1.1         pbapply_1.7-2        polynom_1.4-1       
  [4] gridExtra_2.3        fdrtool_1.2.17       rlang_1.1.3         
  [7] magrittr_2.0.3       e1071_1.7-13         compiler_4.3.2      
 [10] gdata_3.0.0          IsingSampler_0.2.3   reshape2_1.4.4      
 [13] png_0.1-8            vctrs_0.6.4          quadprog_1.5-8      
 [16] stringr_1.5.1        pkgconfig_2.0.3      shape_1.4.6         
 [19] fastmap_1.1.1        backports_1.4.1      pbivnorm_0.6.0      
 [22] utf8_1.2.4           rmarkdown_2.25       NetworkToolbox_1.4.2
 [25] heplots_1.6.0        nloptr_2.0.3         purrr_1.0.2         
 [28] xfun_0.41            glmnet_4.1-8         jomo_2.7-6          
 [31] jsonlite_1.8.7       pan_1.9              jpeg_0.1-10         
 [34] lavaan_0.6-17        broom_1.0.5          parallel_4.3.2      
 [37] cluster_2.1.4        R6_2.5.1             stringi_1.8.1       
 [40] RColorBrewer_1.1-3   smacof_2.1-5         car_3.1-2           
 [43] boot_1.3-28.1        rpart_4.1.21         Rcpp_1.0.11         
 [46] iterators_1.0.14     knitr_1.45           snow_0.4-4          
 [49] base64enc_0.1-3      R.utils_2.12.3       weights_1.0.4       
 [52] Matrix_1.6-5         nnls_1.5             splines_4.3.2       
 [55] nnet_7.3-19          igraph_2.0.1.1       tidyselect_1.2.0    
 [58] rstudioapi_0.16.0    abind_1.4-5          yaml_2.3.7          
 [61] doParallel_1.0.17    codetools_0.2-19     qgraph_1.9.8        
 [64] plyr_1.8.9           lattice_0.21-9       tibble_3.2.1        
 [67] withr_2.5.2          evaluate_0.23        networktools_1.5.1  
 [70] foreign_0.8-85       survival_3.5-7       proxy_0.4-27        
 [73] pillar_1.9.0         carData_3.0-5        mice_3.16.0         
 [76] stats4_4.3.2         checkmate_2.3.0      foreach_1.5.2       
 [79] IsingFit_0.4         ellipse_0.5.0        generics_0.1.3      
 [82] munsell_0.5.0        candisc_0.8-6        scales_1.3.0        
 [85] minqa_1.2.6          gtools_3.9.5         class_7.3-22        
 [88] glue_1.6.2           Hmisc_5.1-1          tools_4.3.2         
 [91] data.table_1.15.4    lme4_1.1-35.1        mvtnorm_1.2-3       
 [94] rgl_1.2.1            grid_4.3.2           plotrix_3.8-4       
 [97] tidyr_1.3.1          colorspace_2.1-0     nlme_3.1-163        
[100] htmlTable_2.4.2      eigenmodel_1.11      Formula_1.2-5       
[103] cli_3.6.2            fansi_1.0.5          glasso_1.11         
[106] corpcor_1.6.10       gtable_0.3.4         R.methodsS3_1.8.2   
[109] digest_0.6.33        wordcloud_2.6        htmlwidgets_1.6.2   
[112] htmltools_0.5.7      R.oo_1.25.0          lifecycle_1.0.4     
[115] mitml_0.4-5          MASS_7.3-60         </code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./横断面网络.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">横断面网络</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./有调节的网络.html" class="pagination-link">
        <span class="nav-page-text">有调节的网络</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>